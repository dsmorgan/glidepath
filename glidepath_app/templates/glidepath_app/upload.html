<!DOCTYPE html>
<html>
<head>
    <title>Glidepath Rules</title>
</head>
<body>
<h1>Glidepath Rules</h1>
{% if error %}
<p style="color:red;">{{ error }}</p>
{% endif %}
<form method="post" enctype="multipart/form-data">
    <input type="file" name="file" required>
    <button type="submit">Upload</button>
</form>
<p><a href="{% url 'export_rules' %}">Export CSV</a></p>
<table border="1">
    <thead>
        <tr>
            <th>gt-retire-age</th>
            <th>lt-retire-age</th>
            <th>Classes</th>
            <th>Categories</th>
        </tr>
    </thead>
    <tbody>
    {% for rule in rules %}
        <tr>
            <td>{{ rule.gt_retire_age }}</td>
            <td>{{ rule.lt_retire_age }}</td>
            <td>
                {% for ca in rule.class_allocations.all %}
                    {{ ca.asset_class.name }}: {{ ca.percentage }}%<br>
                {% endfor %}
            </td>
            <td>
                {% for ca in rule.category_allocations.all %}
                    {{ ca.asset_category.asset_class.name }}:{{ ca.asset_category.name }}: {{ ca.percentage }}%<br>
                {% endfor %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
</body>
</html>
